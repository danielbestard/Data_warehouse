
-- Problem set week 3

-- Please add the proper SQL query to follow the instructions below  

-- 1) Select ecommerce as your default database 

;

-- 2) Show the PK, name, and quantity per unit from all products in stock

;

-- 3) Show the number of products ever on sale in our stores

;

-- 4) Show the number of products in stock (available right now) in our store

;

--  5) Show the number of products with more orders than stock

;

-- 6) List all products available in the store and order them alphabetically from a to z 
-- Show just the first ten products 

;

--  7) Create a new table in a separated schema. Call it Products2 with the same content of table products

; 

--  8) Delete the previously created table

;

--  9) Show how many customer the store has from Mexico

;

-- 10) Show how many different countries our customers come from

;

--  11) Define a new table and call it ReportAlpha 
--  Show all fields from table "categories"
--  Add a field FullName as the concatenation of Category Name and Description
--  if field Picture is NULL Replace it by the 'NULL' string, and
--  if field Picture is the empty string replace it by 'No picture'
--  (hint: use the CONCAT function and the CASE WHEN statement)

;

--  12) Show how many customers are from Mexico, Argentina, or Brazil 
--  whose contact title is  aSales Representative or a Sales Manager

;

--  13) Show the number of employees that are 50 years old or more 
--  as at 2014-10-06 (you will probably need to use the DATE_FORMAT function) 

;

--  14) Show the age of the oldest employee of the company
--  (hint: use the YEAR and DATE_FORMAT functions)

;

--  15) Show the number of products whose quantity per unit is measured in bottles

;

-- 16) Show the number of customers with a Spanish or British common surname
--  (a surname that ends with -on or -ez)

;

--  17) Show how many distinct countries our 
--  customers with a Spanish or British common surname come from
--  (a surname that ends with -on or -ez)

;

--  18) Show the number of products whose names do not contain the letter 'a'
--  (Note: patterns are not case sensitive)

;

--  19) Get the total number of single items sold ever

;

--  20) Get the id of all products sold at least one time

;

--  21) Is there any product that was never sold?

--  22) Get the list of products sorted by category on the following way:
--  2,4,6,7,3,1,5,8
--  i.e. first all products of category 2, then all products of 
--  category 4, and so on.
--  Sort alphabetically by ProductName inside one category (hint: use CASE WHEN)

;



---------------------------------EoC---------------------------------------------